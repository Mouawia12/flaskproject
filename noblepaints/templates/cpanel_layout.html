<!DOCTYPE html>
<html lang="{{ current_lang }}" dir="{{ 'rtl' if current_lang == 'ar' else 'ltr' }}">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ t('meta.site_name') }} â€“ {{ t('admin.nav.dashboard', 'Dashboard') }}</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Alexandria:wght@400;600;700&family=Cairo:wght@400;600;700&display=swap">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" referrerpolicy="no-referrer">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/site.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/admin.css') }}">
    {% block head %}{% endblock %}
</head>
<body class="admin-body">
    <div class="page-overlay" aria-hidden="true">
        <span class="page-overlay__spinner"></span>
    </div>

    <nav class="navbar admin-topbar">
        <div class="container-fluid px-3">
            <button class="btn btn-outline-secondary me-3 d-lg-none" data-sidebar-toggle type="button" aria-label="Toggle navigation">
                <i class="fa fa-bars"></i>
            </button>
            <a class="navbar-brand" href="{{ url_for_lang('cpanel_categories', page=1) }}">
                <img src="{{ url_for('static', filename='images/logo-footer.png') }}" alt="{{ t('meta.site_name') }}">
            </a>
            <div class="ms-auto d-flex align-items-center gap-3">
                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" id="adminLanguageDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                        {{ t('admin.nav.language', 'Language') }}
                    </button>
                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="adminLanguageDropdown">
                        {% for code, label in available_languages.items() %}
                            <li>
                                <a class="dropdown-item{% if current_lang == code %} active{% endif %}" href="{{ switch_lang_url(code) }}">
                                    {{ label }}
                                    {% if current_lang == code %}
                                        <i class="fa fa-check ms-2"></i>
                                    {% endif %}
                                </a>
                            </li>
                        {% endfor %}
                    </ul>
                </div>
                {% if current_user.is_authenticated %}
                    <span class="fw-semibold">{{ t('admin.nav.greeting').replace('{name}', current_user.full_name or current_user.username) }}</span>
                    <a class="btn btn-outline-secondary" href="{{ url_for_lang('logout') }}" data-i18n-key="admin.nav.logout">{{ t('admin.nav.logout', 'Sign out') }}</a>
                {% else %}
                    <a class="btn btn-outline-secondary" href="{{ url_for_lang('login') }}" data-i18n-key="auth.login.submit">{{ t('auth.login.submit', 'Sign in') }}</a>
                {% endif %}
            </div>
        </div>
    </nav>

    <div class="admin-layout">
        <aside class="admin-sidebar">
            <div class="admin-sidebar__header" data-i18n-key="admin.nav.dashboard">{{ t('admin.nav.dashboard', 'Dashboard') }}</div>
            <ul class="admin-sidebar__nav">
                <li><a href="{{ url_for_lang('cpanel_categories', page=1) }}" data-nav-match="/ControlPanel/categories/" data-overlay-trigger><i class="fa fa-layer-group"></i><span data-i18n-key="admin.nav.categories">{{ t('admin.nav.categories', 'Categories') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_products', page=1) }}" data-nav-match="/ControlPanel/products/" data-overlay-trigger><i class="fa fa-box"></i><span data-i18n-key="admin.nav.products">{{ t('admin.nav.products', 'Products') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_catalogs', page=1) }}" data-nav-match="/ControlPanel/catalogs/" data-overlay-trigger><i class="fa fa-book"></i><span data-i18n-key="admin.nav.catalogs">{{ t('admin.nav.catalogs', 'Catalogs') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_TechnicalDatasheets', page=1) }}" data-nav-match="/ControlPanel/TechnicalDatasheets/" data-overlay-trigger><i class="fa fa-file-lines"></i><span data-i18n-key="admin.nav.datasheets">{{ t('admin.nav.datasheets', 'Technical Datasheets') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_news', page=1) }}" data-nav-match="/ControlPanel/news/" data-overlay-trigger><i class="fa fa-newspaper"></i><span data-i18n-key="admin.nav.news">{{ t('admin.nav.news', 'News') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_certificates', page=1) }}" data-nav-match="/ControlPanel/certificates/" data-overlay-trigger><i class="fa fa-award"></i><span data-i18n-key="admin.nav.certificates">{{ t('admin.nav.certificates', 'Certificates') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_approvals', page=1) }}" data-nav-match="/ControlPanel/approvals/" data-overlay-trigger><i class="fa fa-check-circle"></i><span data-i18n-key="admin.nav.approvals">{{ t('admin.nav.approvals', 'Approvals') }}</span></a></li>
                <li><a href="{{ url_for_lang('cpanel_socialIcons', page=1) }}" data-nav-match="/ControlPanel/socialIcons/" data-overlay-trigger><i class="fa fa-share-alt"></i><span data-i18n-key="admin.nav.social">{{ t('admin.nav.social', 'Social Icons') }}</span></a></li>
            </ul>
        </aside>
        <main class="admin-content">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}" role="alert">{{ message }}</div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
            {% block content %}{% endblock %}
        </main>
    </div>

    <script>
        window.APP_LANG = "{{ current_lang }}";
        window.BASE_TRANSLATIONS = {{ base_translations | tojson }};
        window.PAGE_TRANSLATIONS = window.PAGE_TRANSLATIONS || {};
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="{{ url_for('static', filename='js/layout.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/admin.js') }}" defer></script>
    <script src="{{ url_for('static', filename='js/admin-actions.js') }}" defer></script>
    {% block scripts %}{% endblock %}
</body>
</html>
